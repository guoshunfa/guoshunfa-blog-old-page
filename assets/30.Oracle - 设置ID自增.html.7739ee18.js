import{_ as a,r as e,o,c,a as n,b as t,d as p,e as l}from"./app.4659d0e0.js";const i={},d=l(`<h1 id="oracle-设置id自增" tabindex="-1"><a class="header-anchor" href="#oracle-设置id自增" aria-hidden="true">#</a> Oracle - 设置ID自增</h1><h2 id="_1-先有个表" tabindex="-1"><a class="header-anchor" href="#_1-先有个表" aria-hidden="true">#</a> 1. 先有个表</h2><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token comment"># 首先得有个表</span>
<span class="token keyword">create</span> <span class="token keyword">table</span> t_user<span class="token punctuation">(</span>
user_id number <span class="token operator">not</span> <span class="token boolean">null</span> <span class="token keyword">primary</span> <span class="token keyword">key</span><span class="token punctuation">,</span>
user_name varchar2<span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
credits number<span class="token punctuation">,</span>
user_password varchar2<span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
last_visit <span class="token keyword">date</span><span class="token punctuation">,</span>
last_ip varchar2<span class="token punctuation">(</span><span class="token number">23</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_2-创建一个序列" tabindex="-1"><a class="header-anchor" href="#_2-创建一个序列" aria-hidden="true">#</a> 2. 创建一个序列</h2><blockquote><p>转载自：https://blog.csdn.net/jiejie5945/article/details/44198283</p></blockquote><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token comment"># 为这个表创建序列</span>
<span class="token keyword">create</span> sequence T_USER_SEQ
minvalue <span class="token number">1</span>
maxvalue <span class="token number">999999999999999999999999999</span>
<span class="token keyword">start</span> <span class="token keyword">with</span> <span class="token number">21</span>
increment <span class="token keyword">by</span> <span class="token number">1</span>
cache <span class="token number">20</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>参数描述：</p><ul><li><p><code>create sequence seq_name</code>：创建序列，<code>seq_name</code>为序列名称</p></li><li><p><code>minvalue</code>：自增最小值，缺省值为nominvalue，即不设置最小值。</p></li><li><p><code>maxvalue</code>：自增最大值，缺省值为nomaxvalue，即不设置最大值；系统能产生的最大值为10的27次方。</p></li><li><p><code>start with</code>：自增开始值，设置成21则从21开始自增。</p></li><li><p><code>increment by</code>：自增数值，设置成1则每次递增1，负数表示递减，缺省值为1。</p></li><li><p><code>cache</code>：定义缓存序列的个数，缺省值为20，nocache表示不设置缓存；使用缓存可以提高序列的性能，但数据库出错时会造成数据丢失使序列不连续。</p></li><li><p><code>NOCYCLE</code>：一直累加，不循环</p></li><li><p><code>cycle</code>：定义当序列达到最大/小值后是否循环，缺省值为不循环；<code>nocycle</code>：不循环；<strong><code>cycle</code></strong>：循环；如果不使用循环达到限制值后继续产生新值就会出错；使用循环达到最大值后的下一个值为1，和**<code>start</code>** **<code>with</code>**设置的值无关，递增还是<code>increment</code> **<code>by</code>**设置的值；</p></li></ul><h3 id="_2-1-序列详细描述" tabindex="-1"><a class="header-anchor" href="#_2-1-序列详细描述" aria-hidden="true">#</a> 2.1. 序列详细描述</h3><p>一旦定义了<code>emp_sequence</code>，你就可以用<code>CURRVAL</code>，<code>NEXTVAL</code><code>CURRVAL</code> = 返回<code>sequence</code>的当前值 <code>NEXTVAL</code> = 增加<code>sequence</code>的值，然后返回<code>sequence</code>值 比如： <code>emp_sequence.CURRVAL</code><code>emp_sequence.NEXTVAL</code></p><p>可以使用<code>sequence</code>的地方：</p><ul><li>不包含子查询、<code>snapshot</code>、<code>VIEW</code>的 <code>SELECT</code> 语句</li><li><code>INSERT</code>语句的子查询中</li><li><code>NSERT</code>语句的<code>VALUES</code>中</li><li><code>UPDATE</code> 的 <code>SET</code>中</li></ul><p>可以看如下例子：</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> emp <span class="token keyword">VALUES</span>
<span class="token punctuation">(</span>empseq<span class="token punctuation">.</span>nextval<span class="token punctuation">,</span> <span class="token string">&#39;LEWIS&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;CLERK&#39;</span><span class="token punctuation">,</span><span class="token number">7902</span><span class="token punctuation">,</span> SYSDATE<span class="token punctuation">,</span> <span class="token number">1200</span><span class="token punctuation">,</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 

<span class="token keyword">SELECT</span> empseq<span class="token punctuation">.</span>currval <span class="token keyword">FROM</span> DUAL<span class="token punctuation">;</span> 
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>但是要注意的是：</p><ul><li>第一次<code>NEXTVAL</code>返回的是初始值；随后的<code>NEXTVAL</code>会自动增加你定义的<code>INCREMENT BY</code>值， 然后返回增加后的值。<code>CURRVAL</code> 总是返回当前<code>sequence</code>的值，但是在第一次<code>NEXTVAL</code> 初始化之后才能使用<code>CURRVAL</code>，否则会出错。一次<code>NEXTVAL</code>会增加一次<code>sequence</code>的值， 所以如果你在同一个语句里面使用多个<code>NEXTVAL</code>，其值就是不一样的。明白？</li><li>如果指定<code>CACHE</code>值，<code>oracle</code>就可以预先在内存里面放置一些<code>sequence</code>，这样存取的快 些。</li><li><code>cache</code>里面的取完后，<code>oracle</code>自动再取一组到<code>cache</code>。 使用<code>cache</code>或许会跳号， 比如 数据库突然不正常<code>down</code>掉（<code>shutdown abort</code>),<code>cache</code>中的<code>sequence</code>就会丢失. 所以可 以在<code>create sequence</code>的时候用<code>nocache</code>防止这种情况。</li></ul><h3 id="_2-2-调整序列" tabindex="-1"><a class="header-anchor" href="#_2-2-调整序列" aria-hidden="true">#</a> 2.2. 调整序列</h3><p>你或者是该<code>sequence</code>的<code>owner</code>，或者有<code>ALTER ANY sequence</code>权限才能改动<code>sequence</code>。 可 以<code>alter</code>除<code>start</code>值之外的所有<code>sequence</code>参数。如果想要改变<code>start</code>值，必须<code>drop sequence</code> 再<code>re-create</code>。例子：</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">ALTER</span> sequence emp_sequence
INCREMENT <span class="token keyword">BY</span> <span class="token number">10</span>
MAXVALUE <span class="token number">10000</span>
<span class="token keyword">CYCLE</span> <span class="token comment">-- 到10000后从头开始</span>
NOCACHE<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>影响<code>sequence</code>的初始化参数： <code>sequence_CACHE_ENTRIES =</code> 设置能同时被<code>cache</code>的<code>sequence</code>数目。</p><p>可以很简单的<code>Drop sequence </code><code>DROP sequence order_seq; </code></p><h2 id="_3-创建一个触发器" tabindex="-1"><a class="header-anchor" href="#_3-创建一个触发器" aria-hidden="true">#</a> 3. 创建一个触发器</h2><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">create</span> <span class="token operator">or</span> <span class="token keyword">replace</span> <span class="token keyword">trigger</span> t_user_tr
before <span class="token keyword">insert</span> <span class="token keyword">on</span> t_user
<span class="token keyword">for each row</span>
<span class="token keyword">begin</span>
<span class="token keyword">select</span> t_user_seq<span class="token punctuation">.</span>nextval <span class="token keyword">into</span> :new<span class="token punctuation">.</span>user_id <span class="token keyword">from</span> dual<span class="token punctuation">;</span>
<span class="token keyword">end</span> t_user_tr<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>参数描述：</strong></p><ul><li><code>t_user_tr</code>: 随意的名字，不要重复就行</li><li><code>t_user</code>: 表名</li><li><code>user_id</code> ：自增的id</li></ul><p><strong>删除触发器：</strong></p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">DROP</span> <span class="token keyword">TRIGGER</span> trigger_name<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><strong>参数描述</strong></p><ul><li><em>trigger_name</em>：要删除的触发器的名称。</li></ul><h2 id="_4-测试" tabindex="-1"><a class="header-anchor" href="#_4-测试" aria-hidden="true">#</a> 4. 测试</h2><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">insert</span> <span class="token keyword">into</span> t_user <span class="token keyword">values</span><span class="token punctuation">(</span><span class="token boolean">null</span><span class="token punctuation">,</span><span class="token string">&#39;xiaoming&#39;</span><span class="token punctuation">,</span><span class="token number">123</span><span class="token punctuation">,</span><span class="token string">&#39;1114&#39;</span><span class="token punctuation">,</span>sysdate<span class="token punctuation">,</span><span class="token string">&#39;192.168.37.132&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> t_user <span class="token keyword">values</span><span class="token punctuation">(</span><span class="token boolean">null</span><span class="token punctuation">,</span><span class="token string">&#39;xiaoming1&#39;</span><span class="token punctuation">,</span><span class="token number">123</span><span class="token punctuation">,</span><span class="token string">&#39;1114&#39;</span><span class="token punctuation">,</span>sysdate<span class="token punctuation">,</span><span class="token string">&#39;192.168.37.132&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> t_user <span class="token keyword">values</span><span class="token punctuation">(</span><span class="token boolean">null</span><span class="token punctuation">,</span><span class="token string">&#39;xiaoming1&#39;</span><span class="token punctuation">,</span><span class="token number">123</span><span class="token punctuation">,</span><span class="token string">&#39;1114&#39;</span><span class="token punctuation">,</span>sysdate<span class="token punctuation">,</span><span class="token string">&#39;192.168.37.132&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> t_user <span class="token keyword">values</span><span class="token punctuation">(</span><span class="token boolean">null</span><span class="token punctuation">,</span><span class="token string">&#39;xiaoming1&#39;</span><span class="token punctuation">,</span><span class="token number">123</span><span class="token punctuation">,</span><span class="token string">&#39;1114&#39;</span><span class="token punctuation">,</span>sysdate<span class="token punctuation">,</span><span class="token string">&#39;192.168.37.132&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> t_user <span class="token keyword">values</span><span class="token punctuation">(</span><span class="token boolean">null</span><span class="token punctuation">,</span><span class="token string">&#39;xiaoming2&#39;</span><span class="token punctuation">,</span><span class="token number">123</span><span class="token punctuation">,</span><span class="token string">&#39;1114&#39;</span><span class="token punctuation">,</span>sysdate<span class="token punctuation">,</span><span class="token string">&#39;192.168.37.132&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> t_user <span class="token keyword">values</span><span class="token punctuation">(</span><span class="token boolean">null</span><span class="token punctuation">,</span><span class="token string">&#39;xiaoming&#39;</span><span class="token punctuation">,</span><span class="token number">123</span><span class="token punctuation">,</span><span class="token string">&#39;1114&#39;</span><span class="token punctuation">,</span>sysdate<span class="token punctuation">,</span><span class="token string">&#39;192.168.37.132&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> t_user <span class="token keyword">values</span><span class="token punctuation">(</span><span class="token boolean">null</span><span class="token punctuation">,</span><span class="token string">&#39;xiaoming&#39;</span><span class="token punctuation">,</span><span class="token number">123</span><span class="token punctuation">,</span><span class="token string">&#39;1114&#39;</span><span class="token punctuation">,</span>sysdate<span class="token punctuation">,</span><span class="token string">&#39;192.168.37.132&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> t_user <span class="token keyword">values</span><span class="token punctuation">(</span><span class="token boolean">null</span><span class="token punctuation">,</span><span class="token string">&#39;xiaoming&#39;</span><span class="token punctuation">,</span><span class="token number">123</span><span class="token punctuation">,</span><span class="token string">&#39;1114&#39;</span><span class="token punctuation">,</span>sysdate<span class="token punctuation">,</span><span class="token string">&#39;192.168.37.132&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> t_user <span class="token keyword">values</span><span class="token punctuation">(</span><span class="token boolean">null</span><span class="token punctuation">,</span><span class="token string">&#39;xiaoming&#39;</span><span class="token punctuation">,</span><span class="token number">123</span><span class="token punctuation">,</span><span class="token string">&#39;1114&#39;</span><span class="token punctuation">,</span>sysdate<span class="token punctuation">,</span><span class="token string">&#39;192.168.37.132&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> t_user <span class="token keyword">values</span><span class="token punctuation">(</span><span class="token boolean">null</span><span class="token punctuation">,</span><span class="token string">&#39;xiaoming&#39;</span><span class="token punctuation">,</span><span class="token number">123</span><span class="token punctuation">,</span><span class="token string">&#39;1114&#39;</span><span class="token punctuation">,</span>sysdate<span class="token punctuation">,</span><span class="token string">&#39;192.168.37.132&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> t_user
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="参考文章" tabindex="-1"><a class="header-anchor" href="#参考文章" aria-hidden="true">#</a> 参考文章</h2>`,32),u=n("li",null,"https://blog.csdn.net/qq_42055933/article/details/117401672",-1),r={href:"https://blog.csdn.net/QingXu1234/article/details/116048728",target:"_blank",rel:"noopener noreferrer"};function k(v,m){const s=e("ExternalLinkIcon");return o(),c("div",null,[d,n("ul",null,[u,n("li",null,[n("a",r,[t("oracle如何实现ID自增长"),p(s)])])])])}const g=a(i,[["render",k],["__file","30.Oracle - 设置ID自增.html.vue"]]);export{g as default};
